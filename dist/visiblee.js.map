{"version":3,"file":"visiblee.js","sources":["../src/visiblee.ts"],"sourcesContent":["/// <reference path=\"./types.ts\"/>\n\nexport class Visiblee {\n\n\n    /**\n     * The elements to watch.\n     *\n     * @private\n     * @type {Array<Visiblee.Entry>}\n     * @memberof Visiblee\n     */\n    private watchList: Array<Visiblee.Entry> = [];\n\n\n    /**\n     * Creates an instance of Visiblee.\n     * \n     * @private\n     * @memberof Visiblee\n     */\n    private constructor() {\n        if(window.visiblee) { return; }\n\n        window.addEventListener('scroll', () => {\n            this.watchList.forEach(entry => {\n                if(this.isVisible(entry)) {\n                    entry.callback(entry);\n\n                    if(entry.removeOnceVisible) {\n                        Visiblee.unwatch(entry.element);\n                    }\n                }\n            });\n        });\n    }\n\n\n    /**\n     * Add's the elements to the watch list.\n     *\n     * @static\n     * @param {(Array<HTMLElement> | HTMLElement)} elements\n     * @param {(entry:Visiblee.Entry) => void} callback\n     * @param {number} [triggerPoint=0.5]\n     * @param {boolean} [removeOnceVisible=true]\n     * @memberof Visiblee\n     */\n    public static watch(elements: Array<HTMLElement> | HTMLElement, callback: (entry: Visiblee.Entry) => void, triggerPoint = 0.5, removeOnceVisible = true): void {\n        const instance = this.getInstance();\n        \n        if(Array.isArray(elements)) {\n            elements.forEach(element => {\n                instance.watchList.push({element, callback, triggerPoint, removeOnceVisible});\n            });\n        } else {\n            instance.watchList.push({element: elements, callback, triggerPoint, removeOnceVisible});\n        }\n    }\n\n\n    /**\n     * Removes the element from the watch list\n     *\n     * @param {HTMLElement} element\n     * @memberof Visiblee\n     */\n    public static unwatch(element: HTMLElement): void {\n        const instance = this.getInstance();\n        const entry    = instance.watchList.find(entry => entry.element === element);\n\n        if(entry) {\n            instance.watchList = instance.watchList.filter(item => item !== entry);\n        }\n    }\n\n\n\n    /**\n     * Returns true if the provided element is currently visible.\n     *\n     * @param {HTMLElement} element\n     * @param {number} [triggerPoint=0.5]\n     * @returns {boolean}\n     * @memberof Visiblee\n     */\n    public static check(element: HTMLElement, triggerPoint = 0.5): boolean {\n        const instance = this.getInstance();\n\n        return instance.isVisible({\n            element,\n            triggerPoint,\n            callback: () => {},\n            removeOnceVisible: false\n        });\n    }\n\n\n    /**\n     * Binds an instance of Visiblee to the window if it isn't already.\n     *\n     * @static\n     * @memberof Visiblee\n     */\n    public static getInstance(): Visiblee {\n        if(!window.visiblee) {\n            window.visiblee = new Visiblee();\n        }\n        return window.visiblee;\n    }\n\n\n    /**\n     * Returns true if the entry is currently visible.\n     *\n     * @private\n     * @param {Visiblee.Entry} entry\n     * @returns {boolean}\n     * @memberof Visiblee\n     */\n    private isVisible(entry: Visiblee.Entry): boolean {\n        const visibilityOffset = (window.innerHeight / (100 / (100 - (entry.triggerPoint * 100))));\n        return (window.scrollY || window.pageYOffset) >= entry.element.offsetTop - visibilityOffset;\n    }\n}\n"],"names":["Visiblee","constructor","window","visiblee","addEventListener","watchList","forEach","entry","this","isVisible","callback","removeOnceVisible","unwatch","element","watch","elements","triggerPoint","instance","getInstance","Array","isArray","push","find","filter","item","check","visibilityOffset","innerHeight","scrollY","pageYOffset","offsetTop"],"mappings":"IAEaA,EAmBTC,uCAT2C,GAUpCC,OAAOC,UAEVD,OAAOE,iBAAiB,sBACfC,UAAUC,iBAAQC,GAChBC,EAAKC,UAAUF,KACdA,EAAMG,SAASH,GAEZA,EAAMI,qBACIC,QAAQL,EAAMM,eAkBpCb,EAAOc,eAAMC,EAA4CL,EAA2CM,EAAoBL,kBAAL,oBAAyB,OACzIM,EAAWT,KAAKU,cAEnBC,MAAMC,QAAQL,GACbA,EAAST,iBAAQO,GACbI,EAASZ,UAAUgB,KAAK,SAACR,WAASH,eAAUM,oBAAcL,MAG9DM,EAASZ,UAAUgB,KAAK,SAAUN,WAAUL,eAAUM,oBAAcL,OAW9DC,iBAAQC,OACZI,EAAWT,KAAKU,cAChBX,EAAWU,EAASZ,UAAUiB,cAAKf,UAASA,EAAMM,UAAYA,IAEjEN,IACCU,EAASZ,UAAYY,EAASZ,UAAUkB,gBAAOC,UAAQA,IAASjB,QAc1DkB,eAAMZ,EAAsBG,yBAAe,IACpCR,KAAKU,cAENT,UAAU,SACtBI,eACAG,EACAN,yCACmB,KAWpBV,EAAOkB,8BACNhB,OAAOC,WACPD,OAAOC,SAAW,IAAIH,GAEnBE,OAAOC,UAYVM,YAAAA,mBAAUF,OACRmB,EAAoBxB,OAAOyB,aAAe,KAAO,IAA4B,IAArBpB,EAAMS,sBAC5Dd,OAAO0B,SAAW1B,OAAO2B,cAAgBtB,EAAMM,QAAQiB,UAAYJ"}