{"version":3,"file":"isVisible.js","sources":["../src/isVisible.ts"],"sourcesContent":["/// <reference path=\"./types.ts\"/>\n\nexport class IsVisible {\n\n\n    /**\n     * The elements to watch.\n     *\n     * @private\n     * @type {Array<IsVisible.Entry>}\n     * @memberof IsVisible\n     */\n    private watchList: Array<IsVisible.Entry> = [];\n\n\n    /**\n     * Creates an instance of IsVisible.\n     * \n     * @private\n     * @memberof IsVisible\n     */\n    private constructor() {\n        if(window.isVisible) { return; }\n\n        window.addEventListener('scroll', () => {\n            this.watchList.forEach(entry => {\n                if(this.isVisible(entry)) {\n                    entry.callback(entry);\n\n                    if(entry.removeOnceVisible) {\n                        IsVisible.unwatch(entry.element);\n                    }\n                }\n            });\n        });\n    }\n\n\n    /**\n     * Add's the elements to the watch list.\n     *\n     * @static\n     * @param {(Array<HTMLElement> | HTMLElement)} elements\n     * @param {(entry:IsVisible.Entry) => void} callback\n     * @param {number} [triggerPoint=0.5]\n     * @param {boolean} [removeOnceVisible=true]\n     * @memberof IsVisible\n     */\n    public static watch(elements: Array<HTMLElement> | HTMLElement, callback: (entry: IsVisible.Entry) => void, triggerPoint = 0.5, removeOnceVisible = true): void {\n        const instance = this.getInstance();\n        \n        if(Array.isArray(elements)) {\n            elements.forEach(element => {\n                instance.watchList.push({element, callback, triggerPoint, removeOnceVisible});\n            });\n        } else {\n            instance.watchList.push({element: elements, callback, triggerPoint, removeOnceVisible});\n        }\n    }\n\n\n    /**\n     * Removes the element from the watch list\n     *\n     * @param {HTMLElement} element\n     * @memberof IsVisible\n     */\n    public static unwatch(element: HTMLElement): void {\n        const instance = this.getInstance();\n        const entry    = instance.watchList.find(entry => entry.element === element);\n\n        if(entry) {\n            instance.watchList = instance.watchList.filter(item => item !== entry);\n        }\n    }\n\n\n\n    /**\n     * Returns true if the provided element is currently visible.\n     *\n     * @param {HTMLElement} element\n     * @param {number} [triggerPoint=0.5]\n     * @returns {boolean}\n     * @memberof IsVisible\n     */\n    public static check(element: HTMLElement, triggerPoint = 0.5): boolean {\n        const instance = this.getInstance();\n\n        return instance.isVisible({\n            element,\n            triggerPoint,\n            callback: () => {},\n            removeOnceVisible: false\n        });\n    }\n\n\n    /**\n     * Binds an instance of IsVisible to the window if it isn't already.\n     *\n     * @static\n     * @memberof IsVisible\n     */\n    public static getInstance(): IsVisible {\n        if(!window.isVisible) {\n            window.isVisible = new IsVisible();\n        }\n        return window.isVisible;\n    }\n\n\n    /**\n     * Returns true if the entry is currently visible.\n     *\n     * @private\n     * @param {IsVisible.Entry} entry\n     * @returns {boolean}\n     * @memberof IsVisible\n     */\n    private isVisible(entry: IsVisible.Entry): boolean {\n        const visibilityOffset = (window.innerHeight / (100 / (100 - (entry.triggerPoint * 100))));\n        return (window.scrollY || window.pageYOffset) >= entry.element.offsetTop - visibilityOffset;\n    }\n}\n"],"names":["IsVisible","constructor","window","isVisible","addEventListener","watchList","forEach","entry","this","callback","removeOnceVisible","unwatch","element","watch","elements","triggerPoint","instance","getInstance","Array","isArray","push","find","filter","item","check","visibilityOffset","innerHeight","scrollY","pageYOffset","offsetTop"],"mappings":"IAEaA,EAmBTC,uCAT4C,GAUrCC,OAAOC,WAEVD,OAAOE,iBAAiB,sBACfC,UAAUC,iBAAQC,GAChBC,EAAKL,UAAUI,KACdA,EAAME,SAASF,GAEZA,EAAMG,qBACKC,QAAQJ,EAAMK,eAkBrCZ,EAAOa,eAAMC,EAA4CL,EAA4CM,EAAoBL,kBAAL,oBAAyB,OAC1IM,EAAWR,KAAKS,cAEnBC,MAAMC,QAAQL,GACbA,EAASR,iBAAQM,GACbI,EAASX,UAAUe,KAAK,SAACR,WAASH,eAAUM,oBAAcL,MAG9DM,EAASX,UAAUe,KAAK,SAAUN,WAAUL,eAAUM,oBAAcL,OAW9DC,iBAAQC,OACZI,EAAWR,KAAKS,cAChBV,EAAWS,EAASX,UAAUgB,cAAKd,UAASA,EAAMK,UAAYA,IAEjEL,IACCS,EAASX,UAAYW,EAASX,UAAUiB,gBAAOC,UAAQA,IAAShB,QAc1DiB,eAAMZ,EAAsBG,yBAAe,IACpCP,KAAKS,cAENd,UAAU,SACtBS,eACAG,EACAN,yCACmB,KAWpBT,EAAOiB,8BACNf,OAAOC,YACPD,OAAOC,UAAY,IAAIH,GAEpBE,OAAOC,WAYVA,YAAAA,mBAAUI,OACRkB,EAAoBvB,OAAOwB,aAAe,KAAO,IAA4B,IAArBnB,EAAMQ,sBAC5Db,OAAOyB,SAAWzB,OAAO0B,cAAgBrB,EAAMK,QAAQiB,UAAYJ"}